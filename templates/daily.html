{% extends "base.html" %}

{% block page_title %}{{ title }} - {{ date_display }}{% endblock %}

{% block extra_styles %}
.highlights-section {
    background: #fdf6f0;
    border-left: 4px solid #8B0000;
    padding: 15px 20px;
    margin: 20px 0;
}
.highlights-title {
    color: #8B0000;
    font-size: 16px;
    margin-bottom: 10px;
}
.highlights-list {
    list-style: none;
    padding: 0;
}
.highlights-list li {
    padding: 4px 0;
    font-size: 14px;
    line-height: 1.6;
}
{% endblock %}

{% block content %}
<h1 class="report-title">{{ title }}</h1>
<p class="report-subtitle">{{ subtitle }}</p>
<div class="report-meta">
    {{ date_display }} {{ weekday }} &nbsp;&nbsp; 第{{ "%03d"|format(issue_number) }}期
</div>

{% if highlights %}
<div class="highlights-section">
    <h2 class="highlights-title">【本期要点】</h2>
    <ul class="highlights-list">
        {% for h in highlights %}
        <li>{{ h }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<div class="section-divider"></div>

{% set nums = ["一","二","三","四","五","六","七","八","九","十"] %}
{% set ns = namespace(section=0) %}
{% for cat in category_order %}
    {% if cat in categories %}
    {% set ns.section = ns.section + 1 %}
    <div class="category-section">
        <h2 class="category-title">{{ nums[ns.section - 1] if ns.section <= 10 else ns.section }}、{{ cat }}</h2>
        <div class="category-divider"></div>
        {% for art in categories[cat] %}
        <div class="article-item">
            <div class="article-header">
                <span class="importance">{{ "★" * art.importance_score }}</span>
                <span class="article-title">{{ art.title_zh }}</span>
            </div>
            <p class="article-summary">{{ art.summary_zh }}</p>
            <div class="article-meta">
                来源：{{ art.source_name }} | {{ art.published_date or report_date }}
                <a href="{{ art.source_url }}" target="_blank" class="source-link">[原文]</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
{% endfor %}

<div class="footer-section">
    <div class="footer-title">【编辑说明】</div>
    <p class="footer-text">
        本期共监测{{ collection_stats.get('success_sources', 0) }}个信息源，
        采集{{ collection_stats.get('total_articles', 0) }}条动态，
        精选{{ article_count }}条报送。
        数据采集时间：北京时间15:00。
    </p>
    <p class="footer-text" style="margin-top: 5px; font-size: 12px; color: #aaa;">
        生成时间：{{ generated_at }}
    </p>
</div>
{% endblock %}
